FROM caddy:2.8.4-alpine

LABEL org.opencontainers.image.source="https://github.com/intunewithnature/impious"
LABEL org.opencontainers.image.description="Pre-baked imperiumsolis.org / codex.imperiumsolis.com Caddy image (static bundle committed via site/public)"
LABEL org.opencontainers.image.licenses="MIT"

WORKDIR /srv/site

COPY deploy/Caddyfile /etc/caddy/Caddyfile
COPY site/public/ /srv/site/

RUN mkdir -p /srv/codex && \
    test -f /srv/site/index.html
